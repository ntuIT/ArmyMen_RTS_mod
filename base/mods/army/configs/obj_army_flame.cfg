///////////////////////////////////////////////////////////////////////////////
//
// Pandemic Studios
//

#include "fx_army_unit_flamer.cfg"
#includeonce "fx_grunt_damage.cfg"

// UNIT
CreateObjectType("army.unit.flame", "Unit")
{
  GameObj()
  {
    ThinkInterval(1);
    IdleTask("Tasks::UnitIdle");
    Properties()
    {
      Add("Filter::Army");
      Add("Filter::Biological");
      Add("Filter::Weapon");
      Add("Filter::Unit");
      Add("Filter::Transportable");
    }
  }

  MapObj()
  {
    GodFile("army_flamer.god");
    PhysicsModel("Walker");
    TractionType("ground");
    GrainSize(1);

    ArmourClass("infantry");
    HitPoints(300);

    TypeDisplay()
    {
      Image()
      {
        Image("if_flame_portrait.tga", 0, 0, 42, 42);
        Mode("Centre");
      }
    }
    GenericFX()
    {
      Add("UnitObj::ActivelyOnTeam", "flameridle");
      Add("Weapon::Fire", "weapon.flame.fire");
      Add("MapObj::AddToMap", "damage.grunt");
      Add("MapObj::Death", "death.infantry");
      Add("Restore::Target::Process", "restore-small");
      Add("MapObj::AddToMap2", "restore-small-puff");
      // Add("UnitObj::Engine", "water.ripple");
    }
    ShadowFile("army_grunt-shadow.tga");
    RotateShadow(0); // default is 1

  }

  UnitObj()
  {
    TopSpeed(40);
    TurnSpeed(1440);

    SeeingRange(65);

    ResponseEvents()
    {
      Add("Attack")
      {
        Add("army.unit.heavygrunt_attack-0.wav");
        Add("army.unit.heavygrunt_attack-1.wav");
        Add("army.unit.heavygrunt_attack-2.wav");
        Add("army.unit.heavygrunt_attack-3.wav");
      }
      Add("Attacked")
      {
        Add("army.unit.heavygrunt_attacked-0.wav");
        Add("army.unit.heavygrunt_attacked-1.wav");
      }
      Add("Move")
      {
        Add("army.unit.heavygrunt_move-0.wav");
        Add("army.unit.heavygrunt_move-1.wav");
        Add("army.unit.heavygrunt_move-2.wav");
        Add("army.unit.heavygrunt_move-3.wav");
        Add("army.unit.heavygrunt_move-4.wav");
      }
      Add("Select")
      {
        Add("army.unit.heavygrunt_select-0.wav");
        Add("army.unit.heavygrunt_select-1.wav");
        Add("army.unit.heavygrunt_select-2.wav");
        Add("army.unit.heavygrunt_select-3.wav");
        Add("army.unit.heavygrunt_select-4.wav");
      }
      Add("Spotted")
      {
        Add("army.unit.heavygrunt_spotted-0.wav");
      }
    }

    Constructor("army.building.barracks1");
    ConstructionTime(30);
    CreateSource("resource.blob.infantry1");
    CommandCost(1);
    ResourceCost()
    {
      Add("Plastic", 150);
      Add("Electricity", 0);
    }
    Prereqs()
    {
      Add("army.building.barracks2");
    }

    Weapon("army.weapon.flamer");
  }
}

// WEAPON
CreateWeaponType("army.weapon.flamer")
{
  Style("Projectile");

  MaxRange(48);

  HorizAngle(90);
  HorizSeparation(5);
  VertAngle(90);
  VertSeparation(45);

  Delay(0.3);
  LeadAngle(1);
  Speed(200);
  AimAtBox(1);

  Damage()
  {
    Amount(10);

    Effective("infantry", 100%);
    Effective("vehicle", 45%);
    Effective("structure", 45%);
    Effective("flyer", 0%);
    Effective("mine", 45%);
  }
  FirePoints()
  {
    //Add("HP-FIRE");
  }
  Projectile("army.proj.flamer");
}

// PROJECTILE DEFINITION
CreateObjectType("army.proj.flamer", "Projectile")
{
  MapObj()
  {
    Mesh();
    GenericFX()
    {
      Add("ProjectileObj::Hit", "flamewound");
    }
  }

  ProjectileObj()
  {
    TopSpeed(200);
    ProjectileModel("GuidedTrajectory");
    HomingRate(180);
    WaverTurn(0);
    WaverRate(0);
    Explosion("army.exp.flamer");
  }
}

// EXPLOSION DEFINITION
CreateObjectType("army.exp.flamer", "Explosion")
{
  MapObj()
  {
    Mesh();
    GenericFX()
    {
//      Add("ExplosionObj::Explode", "weapon.bazooka.exp");
    }
  }
  ExplosionObj()
  {
    Damage()
    {
      Amount(10);

      Effective("infantry", 100%);
      Effective("vehicle", 45%);
      Effective("structure", 45%);
      Effective("flyer", 0%);
      Effective("mine", 45%);
    }
    AreaInner(8);
    AreaOuter(8);
    Weapon("army.weapon.flamer");
  }
}